import{d as n,e as D,o as s,c as l,a as h,u as K,w as S,F as d,Z as U,b as a,f as A,g as c,v as i,r as b,t as m}from"./app-BvDQBg6p.js";import{_ as N}from"./AdminLayout-C8O1JXpS.js";import{T}from"./toastify-CVFw8R3I.js";import"./ResponsiveNavLink.vue_vue_type_script_setup_true_lang-DC8gbilt.js";const V={class:"py-5"},C={class:"max-w-full mx-auto sm:px-6 lg:px-8"},L=a("h2",{class:"text-lg"},"Export Data",-1),M={class:"bg-white w-full overflow-hidden shadow-sm rounded-lg"},j={class:"p-2 bg-white border-b border-gray-200 overflow-x-auto"},F={class:"sm:col-span-3 px-3 py-2"},O=a("label",{for:"kabupaten",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"KABUPATEN",-1),R=["value"],P={class:"sm:col-span-3 px-3 py-2"},Z=a("label",{for:"kecamatan",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"KECAMATAN",-1),$=["disabled"],q=["value"],z={class:"sm:col-span-3 px-3 py-2"},G=a("label",{for:"desa",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"DESA",-1),H=["disabled"],I=["value"],J={class:"sm:col-span-3 px-3 py-2 order-4 sm:order-4"},Q=a("label",{for:"bloks",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"NBS / NKS",-1),W=["disabled"],X=["value"],Y={class:"sm:col-span-3 px-3 py-2 order-5 sm:order-5"},ee=["disabled"],se={__name:"Export",props:{kabupatens:Object,user_kab:String},setup(f){const u=n(null),k=n(null),g=n([]),p=n(null),y=n([]),_=n(null),x=n([]),o=D({kabupaten:null,kecamatan:null,desa:null,blok:null}),v=async()=>{try{const t=await axios.get("/kecamatan/"+u.value.value);g.value=t.data.kecamatan}catch(t){console.error("Error fetching kecamatan:",t)}},w=async()=>{try{o.desa=null,o.blok=null;const t=await axios.get("/desa/"+u.value.value+"/"+k.value.value);y.value=t.data.desa}catch(t){console.error("Error fetching desa:",t)}},E=async()=>{try{o.blok=null;const t=await axios.get("/blok/"+u.value.value+"/"+k.value.value+"/"+p.value.value);x.value=t.data.blok}catch(t){console.error("Error fetching blok sensus:",t)}};function B(){axios.post(route("admin.export.download"),o,{responseType:"arraybuffer"}).then(t=>{if(t.status===200){const r=new Blob([t.data],{type:"text/csv"}),e=document.createElement("a");e.href=window.URL.createObjectURL(r),e.download="exports.csv",e.click()}else t.status===204&&(console.log({response:t}),T({text:"Data tidak ditemukan",duration:3e3,style:{background:"#e60b0b"}}).showToast())}).catch(t=>{console.error("Error exporting data:",t)})}return(t,r)=>(s(),l(d,null,[h(K(U),{title:"Dashboard"}),h(N,null,{default:S(()=>[a("div",V,[a("div",C,[L,a("div",M,[a("div",j,[a("form",{onSubmit:A(B,["prevent"])},[a("div",F,[O,c(a("select",{"onUpdate:modelValue":r[0]||(r[0]=e=>o.kabupaten=e),ref_key:"refKabupaten",ref:u,name:"kabupaten",onChange:v,class:"form-control sm:col-span-3 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg w-full focus:ring-blue-500 focus:border-blue-500 block p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",id:"kabupatens"},[(s(!0),l(d,null,b(f.kabupatens,e=>(s(),l("option",{value:e.id,key:e.id},m(e.nama),9,R))),128))],544),[[i,o.kabupaten]])]),a("div",P,[Z,c(a("select",{"onUpdate:modelValue":r[1]||(r[1]=e=>o.kecamatan=e),ref_key:"refKecamatan",ref:k,name:"kecamatan",disabled:!o.kabupaten,onChange:w,class:"form-control sm:col-span-3 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg w-full focus:ring-blue-500 focus:border-blue-500 block p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",id:"kecamatans"},[(s(!0),l(d,null,b(g.value,e=>(s(),l("option",{value:e.id,key:e.id},m(e.nama),9,q))),128))],40,$),[[i,o.kecamatan]])]),a("div",z,[G,c(a("select",{"onUpdate:modelValue":r[2]||(r[2]=e=>o.desa=e),ref_key:"refDesa",ref:p,name:"desa",disabled:!o.kecamatan,onChange:E,class:"form-control sm:col-span-3 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg w-full focus:ring-blue-500 focus:border-blue-500 block p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",id:"desas"},[(s(!0),l(d,null,b(y.value,e=>(s(),l("option",{value:e.id,key:e.id},m(e.nama),9,I))),128))],40,H),[[i,o.desa]])]),a("div",J,[Q,c(a("select",{"onUpdate:modelValue":r[3]||(r[3]=e=>o.blok=e),ref_key:"refBlok",ref:_,name:"blok",disabled:!o.desa,class:"form-control sm:col-span-3 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg w-full focus:ring-blue-500 focus:border-blue-500 block p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",id:"bloks"},[(s(!0),l(d,null,b(x.value,e=>(s(),l("option",{value:e.id,key:e.id},m(e.nama),9,X))),128))],8,W),[[i,o.blok]])]),a("div",Y,[a("button",{type:"submit",disabled:!o.kabupaten&&f.user_kab!="00",class:"disabled:bg-gray-200 min-w-15 text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center me-2 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 inline-flex items-center"},"Export",8,ee)])],32)])])])])]),_:1})],64))}};export{se as default};
